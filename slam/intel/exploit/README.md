End-to-End SLAM Exploit
=======================

This SLAM exploit targets upcoming Intel CPUs supporting Linear Address Masking.
As this feature is not out yet, we emulate LAM in software. Therefore, we target
the (existing) i9-13900K CPU running the linux-6.3-emulate-lam kernel, that
emulates LAM upon the supported gadgets. See [kernel](../../../kernel) for
the kernel installation instructions.

The file [slam.h](../lib/slam.h) contains many configuration constants. For
example, `VERBOSITY` allows you to set the verbosity of the output, and
`INTERACTIVE` tweaks the output for an interactive vs not-interactive user.

The exploit currently supports exploitation of unmasked Spectre gadgets in the
following Linux 6.3 functions:
```
cgroup_seqfile_show
ext4_file_open
ext4_file_write_iter
hugetlbfs_read_iter
kernfs_fop_read_iter
kernfs_seq_show
proc_single_show
raw_seq_start
sel_read_mls
shmem_fault
shmem_statfs
```

You have to choose one gadget when building the exploit, e.g.:
```
make CFLAGS=-DCGROUP_SEQFILE_SHOW
```

Make sure you are running on the `linux-6.3-lam` kernel, cf.
[kernel](../../../kernel), and then run the exploit with:
```
./slam
```

Results
-------
You can find the raw output data of multiple runs that we used in the paper in
the [results](results) folder (ran non-interactively, verbosity level 1). It
also contains the script that parses all data, computes the results in Table 3
and plots Figure 12.
